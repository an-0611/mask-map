{"version":3,"sources":["cross.png","user.png","components/SearchMap.js","containers/index.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","icon","cross","userIcon","user","reverse","position","Array","length","SearchMap","props","getMyselfPosition","Promise","res","rej","navigator","geolocation","getCurrentPosition","onEachFeature","feature","layer","pointTolayer","latlng","filterFeatures","state","myselfPos","selfLoading","geoJson","this","L","geoJSON","then","setState","coords","latitude","longitude","style","display","alignItems","justifyContent","width","height","float","Map","center","zoom","minZoom","maxZoom","marginTop","ZoomControl","TileLayer","url","Marker","draggable","opacity","Tooltip","permanent","offset","disableClusteringAtZoom","features","map","pharmacy","i","key","geometry","coordinates","properties","name","phone","address","mask_adult","mask_child","updated","Component","MapContainer","fetchDataLoading","fetch","json","textAlign","top","right","background","zIndex","AppContainer","styled","div","App","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.94925ff0.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAgMAAACdGdVrAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAACmAAAApgHdff84AAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAxQTFRF////71pa71lZ71lZ4STJlQAAAAN0Uk5TAIDAWpGeJQAAACJJREFUCJljYGD8/9+BgYF4KjTs//+poQz/wYB0CqqdVGsBVoRWaQ5O6ccAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAhQAAAIUB4uz/wQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAF4SURBVEiJ7ZK9S0JRGIef1ytGEUQYCC1F0NQSNARNzQVNomRz/0AEkRIR4QfUHyBIQ0GlQgRBrS1tjVFbS0MQFCH0gZX3NKjgVTvnqkFLv/E9932e8577ilIKY9aCo5SsBDBVqVxgSZTN7K2pVYyC6Pwk2OdAd93JG0qmSWYvde0evV4EZe82gQP0IGpHfzvTBKvBEcTSP4Othkjl7346NkzgCejvB3g9g7pjvcDmBtD9pBJF31X7glS+gEhG80Warb3X9gUAH74lhOOGunDEZ9eKqd28ptXEQhEUsyAKxSnJ3KGbNsMWLfTD1zYe5lAMODt5xOYEvMsk959bF0TDM0AG0G4JcA8sksiduRfEwiEUOQO4jkSYeC5vFsQiAVTpGvC3JIAnxBojfvBQW2zcIlVKtwEH8Fd6HXFOsBHqpSiFpmJ3selSfaznX6oFJ+id8Q7gZV6ZUVOojcVEB/CmDKdAyXDHgjpGvUB+QeBgdPLervIv+HvBNzwSdktpTcNGAAAAAElFTkSuQmCC\"","import React, { Component } from 'react';\nimport L from 'leaflet';\nimport { Map, Marker, TileLayer, Tooltip } from 'react-leaflet';\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\nimport 'react-leaflet-markercluster/dist/styles.min.css';\n\nimport 'leaflet/dist/leaflet.css';\nimport cross from '../cross.png';\nimport user from '../user.png';\n\nconst icon = {\n  \"iconUrl\": cross,\n  \"iconSize\": [16, 16],\n  \"iconAnchor\": [12, 41],\n  \"popupAnchor\": [1, -34],\n  \"shadowSize\": [41, 41]\n}\n\nconst userIcon = {\n  \"iconUrl\": user,\n  \"iconSize\": [22, 22],\n  \"iconAnchor\": [12, 41],\n  \"popupAnchor\": [1, -34],\n  \"shadowSize\": [41, 41]\n}\n\nconst reverse = (position) => {\n  if (!position instanceof Array) return;\n  if (position.length !== 2) return;\n  return [position[1], position[0]];\n}\n\nclass SearchMap extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      myselfPos: [],\n      selfLoading: true,\n    };\n  }\n\n  componentDidMount() {\n    // console.log(MarkerClusterGroup)\n    const { geoJson } = this.props;\n    L.geoJSON(geoJson, {\n      onEachFeature: this.onEachFeature,\n      // pointToLayer: this.pointTolayer,\n      // filter: this.filterFeatures,\n    });\n\n    // console.log(geojsonLayer);\n\n    // getmyselfposition to state\n    this.getMyselfPosition().then(res => {\n      if (this.state.myselfPos.length !== 0) return;\n      this.setState({\n        myselfPos: [res.coords.latitude, res.coords.longitude],\n        selfLoading: false,\n      });\n    });\n  }\n\n  // componentDidUpdate(prevProps, prevState) {\n  //   console.log(prevState)\n  //   // 調用組件的處理程序時，它將根據其支持的動態屬性更新其Leaflet實例。\n  // }\n\n  getMyselfPosition = () => {\n    return new Promise((res, rej) => {\n        navigator.geolocation.getCurrentPosition(res, rej);\n    });\n  }\n\n  onEachFeature = (feature, layer) => {\n    // if (feature.properties) {\n    //   // 點擊該maker出現的光箱\n    //   // assemble the HTML for the markers' popups (Leaflet's bindPopup method doesn't accept React JSX)\n    //   const popupContent = `<h3>'name'</h3>\n    //     <strong>Access to MTA lines: </strong>linestr`;\n    //   // add our popups\n    //   layer.bindPopup(popupContent);\n    // }\n  }\n\n  pointTolayer = (feature, latlng) => {\n    // 圖標渲染該點\n    // var markerParams = {\n    //   radius: 4,\n    //   fillColor: 'orange',\n    //   color: '#fff',\n    //   weight: 1,\n    //   opacity: 0.5,\n    //   fillOpacity: 0.8\n    // };\n    // return L.circleMarker(latlng, markerParams);\n  }\n\n  filterFeatures = (feature, layer) => {\n    //  根據當前索引過濾地圖\n    // const test = feature.properties.LINE.split('-').indexOf(this.state.subwayLinesFilter);\n    // if (this.state.subwayLinesFilter === '*' || test !== -1) {\n    //   return true;\n    // }\n  }\n\n  componentWillUnmount() {\n    // 調用組件的處理程序時，如果相關，它將從地圖中刪除其圖層。\n  }\n\n  render() {\n    const { geoJson } = this.props;\n    const { selfLoading, myselfPos } = this.state;\n    if (!navigator.geolocation) return;\n    if (selfLoading) return (\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', width: '100%', height: '100%', float: 'right' }}>\n        <div>Loading...</div>\n      </div>\n    );\n\n    return (\n      <Map\n        center={myselfPos}\n        zoom={14}\n        minZoom={13}\n        maxZoom={18}\n        style={{ width: '100%', height: '100%', marginTop: '20px' }}\n        // position='bottomright'\n        ZoomControl={false}\n        // onClick={() => {}}\n        // onViewportChanged={() => { console.log('change')}}\n        // viewport={position}>\n      >\n        <TileLayer url=\"https://api.tiles.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw\" />\n        <Marker position={myselfPos} icon={L.icon(userIcon)} draggable={false} opacity={1}>\n          <Tooltip permanent offset={[0, -36]}>\n            <div>現在位置</div>\n          </Tooltip>\n        </Marker>\n\n        <MarkerClusterGroup disableClusteringAtZoom={16}>\n        { geoJson.features.map((pharmacy, i) => (\n              <Marker key={i} position={reverse(pharmacy.geometry.coordinates)} icon={L.icon(icon)}>\n                <Tooltip offset={[0, -36]}>\n                  <div>{pharmacy.properties.name}</div>\n                  <div>{`電話：${pharmacy.properties.phone ? pharmacy.properties.phone : '無' }`}</div>\n                  <div>{`地址：${pharmacy.properties.address ? pharmacy.properties.address : '無' }`}</div>\n                  <div>{`成人口罩數量：${pharmacy.properties.mask_adult ? pharmacy.properties.mask_adult : '確認中'}`}</div>\n                  <div>{`兒童口罩數量：${pharmacy.properties.mask_child ? pharmacy.properties.mask_child : '確認中'}`}</div>\n                  <div>{`更新時間：${pharmacy.properties.updated ? pharmacy.properties.updated : '確認中'}`}</div>\n                </Tooltip>\n                {/* <Popup>\n                  <div>{pharmacy.properties.name}</div>\n                  <div>{`電話：${pharmacy.properties.phone ? pharmacy.properties.phone : '無' }`}</div>\n                  <div>{`地址：${pharmacy.properties.address ? pharmacy.properties.address : '無' }`}</div>\n                  <div>{`成人口罩數量：${pharmacy.properties.mask_adult ? pharmacy.properties.mask_adult : '確認中'}`}</div>\n                  <div>{`兒童口罩數量：${pharmacy.properties.mask_child ? pharmacy.properties.mask_child : '確認中'}`}</div>\n                  <div>{`更新時間：${pharmacy.properties.updated ? pharmacy.properties.updated : '確認中'}`}</div>\n                </Popup> */}\n              </Marker>\n            ))\n          }\n        </MarkerClusterGroup>\n      </Map>\n    );\n  }\n}\n\nexport default SearchMap;","import React, { Component, Fragment } from 'react';\n// import SideBar from '../components/SideBar';\nimport SearchMap from '../components/SearchMap';\n\n\nclass MapContainer extends Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n          geoJson: {},\n          fetchDataLoading: true,\n        //   isReduce: false,\n      };\n    }\n    \n    componentDidMount() {\n        const a = fetch('https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json').then(res => res.json());\n        a.then(geoJson => {\n            this.setState({\n                geoJson,\n                fetchDataLoading: false,\n            });\n        });\n    }\n\n    // handleToggle = () => {\n    //     const { isReduce } = this.state;\n    //     this.setState({ isReduce: !isReduce });\n    // }\n\n    render() {\n        // const { isReduce } = this.state;\n        const { fetchDataLoading, geoJson } = this.state;\n        if (fetchDataLoading) return (\n            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', width: '100%', height: '100%', float: 'right' }}>\n                <div>Loading...</div>\n            </div>\n        );\n        const csss = {\n            width: '100%',\n            textAlign: 'center',\n            position: 'fixed',\n            top: '0',\n            right: '0',\n            background: 'white',\n            zIndex: '999999999999',\n        }\n        return (\n            <Fragment>\n                <div style={csss}>提醒您，目前部分藥局採用抽號領取，實際數量需電話聯繫店家查詢</div>\n                {/* <SideBar geoJson={geoJson} isReduce={isReduce} handleToggle={this.handleToggle} /> */}\n                <SearchMap geoJson={geoJson} />\n            </Fragment>\n        );\n    }\n}\n\nexport default MapContainer;\n","import React from 'react';\nimport styled from 'styled-components';\nimport MapContainer from './containers/index';\n\nconst AppContainer = styled.div`\n  width: 100vw;\n  height: 100vh;\n`\n\nfunction App() {\n  return (\n    <AppContainer>\n      <MapContainer />\n    </AppContainer>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}